<cdk-virtual-scroll-viewport [itemSize]="56" class="queue-viewport ms-viewport">
  <ng-container *cdkVirtualFor="let queueItem of dataSource; let last = last">
    @if (queueItem) {
      <app-node-list-item
        [key]="queueItem.id"
        [nodeType]="queueItem.type"
        [defaultIcon]="queueItem.mdIcon"
        [loadingStatus]="loadingStatus"
        [audioPlayerState]="audioPlayerState"
        [disabled]="queueItem.disabled"
        [editing]="editQueueForm.editing"
        [selectable]="queueItem.itemType === QueueSnapshotItemType.User && !queueItem.isCurrentQueuePosition"
        [last]="last"
        (contentClick)="onNodeClick($event)"
        (selectedChange)="onNodeSelectedChanged($event)"
        >
        <div appNodeListItemTitle>
          {{ queueItem.name }}
        </div>
        <app-file-metadata-subtitle appNodeListItemSubtitle
          [metadata]="queueItem.file.metadata"
          />
          @if (queueItem.itemType === UserItemType) {
            <mat-icon
              matTooltip="Added by user"
              extra-action-list-content
              class="user-queue-item-icon node-list-item-action-list-context-menu">
              person_add
            </mat-icon>
          }
          <app-add-to-queue-button
            [file]="queueItem.file"
            />
            @if (queueItem.itemType === UserItemType && !queueItem.isCurrentQueuePosition) {
              <app-remove-from-queue-button
                [item]="queueItem"
                />
            }
            <app-open-location-button
              [folder]="queueItem.file.parent"
              />
            </app-node-list-item>
          }
          @else {
            <app-node-list-item
              defaultIcon="description"
              />
          }
        </ng-container>
      </cdk-virtual-scroll-viewport>
